C51 COMPILER V9.52.0.0   MAIN                                                              09/05/2023 19:11:09 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\keilc51\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "reg52.h"
   2          #include <intrins.h>
   3          
   4          sbit SDA = P0^3;
   5          sbit SCL = P0^1;
   6          
   7          code unsigned char peiqi[]=
   8          {
   9          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x30,0x90,0x50,0x50,0x90,0x20,0x7E,
  10          0xC1,0x1D,0x64,0x44,0x79,0x02,0xBC,0x90,0xD0,0x50,0x90,0x88,0x28,0x68,0xA8,0x28,
  11          0xA8,0x04,0xE4,0x54,0x54,0x64,0x68,0x48,0x90,0x20,0xC0,0x00,0x00,0x00,0x00,0x00,
  12          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  13          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  14          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  15          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  16          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  17          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x04,0xC9,0x32,0x84,0x65,0x13,0x08,
  18          0x05,0x3C,0x46,0x92,0x81,0x05,0xB9,0x83,0x6C,0x10,0x10,0x14,0x17,0x20,0x0C,0x03,
  19          0x07,0x08,0x13,0xA4,0xAC,0x4A,0x12,0x92,0x4F,0x20,0x0F,0x00,0x00,0x00,0x00,0x00,
  20          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  21          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  22          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  23          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  24          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  25          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0x07,0xF0,0xFE,0x04,0x72,0x88,0x09,
  26          0x0A,0x8A,0x64,0x08,0xF0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x04,
  27          0xCA,0x71,0x85,0x3C,0xC2,0x02,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  28          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  29          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  30          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  31          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  32          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  33          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x1C,0x61,0x8E,0x13,0x44,0x84,0x85,
  34          0x05,0x04,0x02,0x01,0x03,0x04,0x09,0x1A,0x12,0x14,0x14,0x14,0x12,0x8B,0x48,0x82,
  35          0xB1,0x4C,0xE3,0x1C,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  36          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x06,
  37          0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  38          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  39          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  40          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  41          0xF0,0x08,0x08,0x48,0x08,0xA8,0x84,0x54,0xC4,0x62,0x02,0xE3,0x1C,0x06,0x02,0x04,
  42          0x05,0x09,0x0A,0x0A,0x0A,0x02,0x0A,0x0A,0x1A,0x19,0x01,0x05,0x04,0x02,0x02,0x01,
  43          0x03,0x0C,0x71,0x82,0x22,0xC4,0x54,0x44,0xA8,0x08,0x68,0x08,0x08,0x40,0x10,0x00,
  44          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  45          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  46          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  47          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  48          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  49          0x31,0x4A,0x8A,0x06,0x12,0x83,0xA2,0x84,0x07,0xE0,0x0F,0x00,0x00,0x00,0x00,0x00,
  50          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  51          0x00,0x00,0x00,0x07,0xF8,0x03,0x3C,0xE0,0x00,0x00,0x02,0x01,0x02,0x00,0x00,0x00,
  52          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  53          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  54          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  55          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
C51 COMPILER V9.52.0.0   MAIN                                                              09/05/2023 19:11:09 PAGE 2   

  56          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  57          0x00,0x00,0x00,0x01,0x01,0x00,0x0C,0x03,0x10,0x17,0x14,0x14,0x14,0xD4,0x34,0x84,
  58          0x04,0xF4,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0xF4,0x04,0xC4,0x04,
  59          0xF4,0x94,0x54,0x54,0x54,0x57,0x10,0x4F,0xA0,0x40,0x00,0x00,0x00,0x00,0x00,0x00,
  60          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  61          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,
  62          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  63          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  64          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  65          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x01,0x08,0x08,
  66          0x10,0x15,0x15,0x15,0x15,0x11,0x0C,0x00,0x00,0x00,0x00,0x00,0x07,0x08,0x00,0x08,
  67          0x0A,0x0A,0x0A,0x0A,0x08,0x00,0x01,0x90,0x90,0x00,0x80,0x80,0x90,0x90,0x80,0x20,
  68          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  69          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  70          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  71          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  72          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  73          };
  74          
  75          
  76          void iic_start() {
  77   1        SCL = 1;
  78   1        SDA = 1;
  79   1        _nop_();
  80   1        SDA = 0;
  81   1        _nop_();
  82   1      }
  83          
  84          void iic_stop() {
  85   1        SCL = 1;
  86   1        SDA = 0;
  87   1        _nop_();
  88   1        SDA = 1;
  89   1        _nop_();
  90   1      }
  91          
  92          char iic_ack() {
  93   1        char result;
  94   1        SCL = 1;
  95   1        result = SDA;
  96   1        _nop_();
  97   1        SCL = 0;
  98   1        _nop_();
  99   1        return result;
 100   1      }
 101          
 102          void iic_sendByte(char byte) {
 103   1        char temp = byte;
 104   1        int i;
 105   1        for(i = 0; i < 8; i ++) {
 106   2          SCL = 0;
 107   2          SDA = temp & 0x80;
 108   2          _nop_();
 109   2          SCL = 1;
 110   2          _nop_();
 111   2          // 拉低电平
 112   2          SCL = 0;
 113   2          _nop_();
 114   2          temp <<= 1;
 115   2        }
 116   1      }
 117          
C51 COMPILER V9.52.0.0   MAIN                                                              09/05/2023 19:11:09 PAGE 3   

 118          void iic_write_cmd(char cmd) {
 119   1        iic_start();
 120   1        // 01111100 + R/W(0是写操作)
 121   1        iic_sendByte(0x78);
 122   1        iic_ack();
 123   1        // C0 + D/C + XXXXXX  ==> D/C = 1 表示数据  = 0 表示命令  
 124   1        iic_sendByte(0x00);
 125   1        iic_ack();
 126   1        iic_sendByte(cmd);
 127   1        iic_ack();
 128   1        iic_stop();
 129   1      }
 130          
 131          void iic_write_data(char d) {
 132   1        iic_start();
 133   1        // 01111100 + R/W(0是写操作)
 134   1        iic_sendByte(0x78);
 135   1        iic_ack();
 136   1        // C0 + D/C + XXXXXX  ==> D/C = 1 表示数据  = 0 表示命令  
 137   1        iic_sendByte(0x40);
 138   1        iic_ack();
 139   1        iic_sendByte(d);
 140   1        iic_ack();
 141   1        iic_stop();
 142   1      }
 143          
 144          
 145          void oled_init() {
 146   1        iic_write_cmd(0xAE);//--display off
 147   1        iic_write_cmd(0x00);//---set low column address
 148   1        iic_write_cmd(0x10);//---set high column address
 149   1        iic_write_cmd(0x40);//--set start line address  
 150   1        iic_write_cmd(0xB0);//--set page address
 151   1        iic_write_cmd(0x81); // contract control
 152   1        iic_write_cmd(0xFF);//--128   
 153   1        iic_write_cmd(0xA1);//set segment remap 
 154   1        iic_write_cmd(0xA6);//--normal / reverse
 155   1        iic_write_cmd(0xA8);//--set multiplex ratio(1 to 64)
 156   1        iic_write_cmd(0x3F);//--1/32 duty
 157   1        iic_write_cmd(0xC8);//Com scan direction
 158   1        iic_write_cmd(0xD3);//-set display offset
 159   1        iic_write_cmd(0x00);//
 160   1        
 161   1        iic_write_cmd(0xD5);//set osc division
 162   1        iic_write_cmd(0x80);//
 163   1        
 164   1        iic_write_cmd(0xD8);//set area color mode off
 165   1        iic_write_cmd(0x05);//
 166   1        
 167   1        iic_write_cmd(0xD9);//Set Pre-Charge Period
 168   1        iic_write_cmd(0xF1);//
 169   1        
 170   1        iic_write_cmd(0xDA);//set com pin configuartion
 171   1        iic_write_cmd(0x12);//
 172   1        
 173   1        iic_write_cmd(0xDB);//set Vcomh
 174   1        iic_write_cmd(0x30);//
 175   1        
 176   1        iic_write_cmd(0x8D);//set charge pump enable
 177   1        iic_write_cmd(0x14);//
 178   1        
 179   1        iic_write_cmd(0xAF);//--turn on oled panel    
C51 COMPILER V9.52.0.0   MAIN                                                              09/05/2023 19:11:09 PAGE 4   

 180   1      }
 181          
 182          
 183          void oled_clear() {
 184   1        int i, j;
 185   1        for(i = 0; i < 8; i ++) {
 186   2          iic_write_cmd(0xB0+i);
 187   2          iic_write_cmd(0x00);
 188   2          iic_write_cmd(0x10);
 189   2          for(j = 0; j < 128; j ++) {
 190   3            iic_write_data(0);
 191   3          }
 192   2        }
 193   1      }
 194          
 195          
 196          void oled_image(unsigned char *image)
 197          {
 198   1        unsigned char i; 
 199   1        unsigned int j;
 200   1        
 201   1        for(i=0;i<8;i++){
 202   2          iic_write_cmd(0xB0 + i);
 203   2          iic_write_cmd(0x00);
 204   2          iic_write_cmd(0x10);
 205   2        
 206   2          for(j = 128 * i; j<(128 * (i+1));j++){
 207   3            iic_write_data(image[j]);
 208   3          }
 209   2        }
 210   1      }
 211          
 212          void main() {
 213   1        
 214   1        oled_init();
 215   1        
 216   1        // 3、addressing setting command table 第三行
 217   1        iic_write_cmd(0x20);
 218   1        iic_write_cmd(0x02);
 219   1        
 220   1        oled_clear();
 221   1        
 222   1        oled_image(peiqi);
 223   1        
 224   1        while(1);
 225   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    392    ----
   CONSTANT SIZE    =   1024    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
